# NUS-FSP-PWC Tax Assistant

A Singapore tax information assistant utilizing Retrieval Augmented Generation (RAG) to provide accurate tax information.

## Project Overview

This system uses a RAG architecture to:
1. Convert user queries into text embeddings
2. Find relevant tax categories via vector similarity search
3. Retrieve relevant articles that match those categories or have similar content
4. Generate informative responses using a combination of OpenAI's GPT models and retrieved context

## Setup Instructions

1. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

2. Set up environment variables in a `.env` file:
   ```
   OPENAI_API_KEY=your_api_key_here
   ```

3. Generate embeddings for the tags database:
   ```bash
   python generate_embeddings.py
   ```
   This will:
   - Read the original tags database (`tags_vector_database.csv`)
   - Generate embeddings for each tag using OpenAI's API
   - Store embeddings in separate JSON files in the `embeddings_data` directory
   - Create a new CSV with references to these embedding files (`tags_vector_database_with_embeddings.csv`)

4. (Optional but recommended) Generate summaries and embeddings for the articles database:
   ```bash
   python generate_article_embeddings.py
   ```
   This will:
   - Read the original articles database (`scraped_data.csv`)
   - For each article, generate a concise summary using GPT-4o-mini
   - Generate embeddings for each summary
   - Store embeddings in separate JSON files in the `article_embeddings` directory
   - Create a new CSV with summaries and references to embedding files (`articles_with_embeddings.csv`)

5. Run the chatbot:
   ```bash
   python main.py
   ```

## File Structure

- `TagEmbeddingGenerator.py` - Generates embeddings for tags
- `ArticleEmbeddingGenerator.py` - Generates summaries and embeddings for articles
- `RAGServices.py` - Core RAG implementation for finding relevant information 
- `ChatBotGUI.py` - Simple CLI interface for the chatbot
- `GPTServices.py` - Utilities for interacting with OpenAI API
- `tags_vector_database.csv` - Original database of tax categories
- `tags_vector_database_with_embeddings.csv` - Database with references to tag embedding files
- `embeddings_data/` - Directory containing tag embedding vectors as JSON files
- `scraped_data.csv` - Original database of scraped tax articles
- `articles_with_embeddings.csv` - Enhanced database with article summaries and embedding references
- `article_embeddings/` - Directory containing article embedding vectors as JSON files

## How It Works

1. User enters a tax-related query
2. The system generates a text embedding for the query
3. The system uses two retrieval methods in parallel:
   - **Tag-based retrieval**: Finds relevant tax categories via embedding similarity
   - **Content-based retrieval**: Finds relevant articles via embedding similarity (if article embeddings exist)
4. The system combines results from both retrieval methods, prioritizing the most relevant content
5. This context is provided to GPT along with the user query
6. GPT generates a response based on the context and query

## Dual Retrieval Architecture

The system uses a dual retrieval approach:

### Tag-Based Retrieval
- Finds tax categories that semantically match the query
- Retrieves articles tagged with these categories
- Good for categorized content and consistent taxonomies

### Content-Based Retrieval (Enhanced)
- Directly compares query embeddings with article embeddings
- Finds semantically similar content regardless of tags
- Requires article summaries and embeddings (generated by `generate_article_embeddings.py`)
- More accurate for nuanced queries but computationally intensive

The system automatically uses both methods when article embeddings are available, or falls back to tag-based retrieval if they're not.
